### Downloading Power view
Download PowerView from this link, In the Recon Folder
https://github.com/PowerShellMafia/PowerSploit

### Domain Enumeration with PowerView

First load the command prompt and go to the powerview folder
Open Powershell by typing the following command
```powershell
powershell -ep bypass
```

This will open powershell. Now open Powerview by
```powershell
. .\PowerView.ps1
```

Now type the following commands to enumerate the domain
```powershell
Get-NetDomain # This is used to get information about the domain
```
![[Pasted image 20210725101910.png]]

```powershell
Get-NetDomainController # This is used to get specific information about the domain Controller
```
![[Pasted image 20210725102145.png]]

```powershell
Get-DomainPolicy # This is used to get information about Domain Policy
```
![[Pasted image 20210725102406.png]]

```powershell
(Get-DomainPolicy)."SystemAccess" # This will give you specific policies in this case system accesss
```
![[Pasted image 20210725102759.png]]

We can see that the MinimumPasswordAge is 1 day and MaximumPasswordAge is 42 days

```powershell
Get-NetUser # This will list all the users
```
![[Pasted image 20210725103112.png]]

```powershell
Get-NetUser | select cn # This will only display the user
Get-NetUser | select samaccountname # This will display user's sam account name
Get-NetUser | select description # This will only give user's description
```
![[Pasted image 20210725103448.png]]
![[Pasted image 20210725103507.png]]

```powershell
Get-UserProperty # This will list all the properties of users
Get-UserProperty -Properties pwdlastset # This will give information of the pwdlastset property of all users
Get-UserProperty -Properties logoncount # This will give the logoncount
Get-UserProperty -Properties badpwdcount # This will get the bad password count of all users
```
**Note** - If the logon count of a user is 0 that is may be a honeypot account. If you compromise that system that can alert the network

```powershell
Get-NetComputer # This will give all the information on how many computers are there in the network
```
![[Pasted image 20210725110557.png]]

```powershell
Get-NetComputer | select OperatingSystem # This will list the operating systems the computers are using
```
![[Pasted image 20210725110851.png]]

```powershell
Get-NetGroup  # This will list all the groups
```
![[Pasted image 20210725111042.png]]

```powershell
Get-NetGroupMember # This will list the member of a group
```
![[Pasted image 20210725111528.png]]

```powershell
Invoke-ShareFinder # List all the shares in the domain
```
```powershell
Get-NetGPO # Lists all the group policies
```
![[Pasted image 20210725112034.png]]

```powershell
Get-NetGPO | select displayname, whenchanged # This will list only the name of the policy and the last changed date
```
![[Pasted image 20210725112250.png]]

### CheatSheet of PowerView
https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993