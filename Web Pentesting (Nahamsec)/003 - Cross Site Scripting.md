### What is XSS
XSS allows an attacker to execute arbitrary client-side code on a victim's browser. XSS can be used for phishing, exfiltrating data, account takeovers and more

### How does XSS work?
-> An attacker inserts a malicious script (or a payload) into the victim's browser
-> When the victim's encounters the script it executes in the victim's browser 
-> A malicious payload is able to perform any action that the victim is able to perform
-> If the victim has special privileges it can be a serious vulnerability 

### Impact
-> Read/Modify/Delete content of any page
-> Steal a users cookies or session and gain access to their account
-> Serve malicious content like phishing
![[Pasted image 20211117170734.png]]

### Types of XSS
![[Pasted image 20211117170849.png]]

#### Reflected XSS
![[Pasted image 20211117171012.png]]

#### Stored XSS
![[Pasted image 20211117171220.png]]

#### DOM XSS
![[Pasted image 20211117171410.png]]

#### Exercises
##### 1st website
![[Pasted image 20211117174220.png]]

We can see that it has a name section as an input field so when we enter the name

![[Pasted image 20211117174339.png]]

It reflects the name in the page, so let's try inserting name with underline tags `<u>name</u>`

![[Pasted image 20211117174441.png]]
![[Pasted image 20211117174507.png]]

So we can see that it is rendering HTML, it is a HTML injection lets escalate it to XSS. Instead of HTML tags we will try putting javascript tag `<script>alert(1)</script>`

![[Pasted image 20211117174650.png]]
![[Pasted image 20211117174727.png]]

##### 2nd website
![[Pasted image 20211117175043.png]]

We can see that it has a name section as an input field so when we enter the name

![[Pasted image 20211117175124.png]]

We can see that the name is reflected on the input field or in a box. Checking the devtools

![[Pasted image 20211117175310.png]]

We can see that it is appearing in the input tags so lets break out of input tags. Here we can see that the `test` is appeared as `<input value = "test"` but it is not closed what if we close the tag and execute our own JS like this `test"><script>alert(1)</script` if you see carefully the `"` after the test will close the starting quotes and the `>` will close the `<input` tag and after closing we are normally executing javascript

![[Pasted image 20211117175701.png]]
![[Pasted image 20211117175713.png]]
![[Pasted image 20211117175752.png]]

##### 3rd website
![[Pasted image 20211117175914.png]]

We can see that it has a name section as an input field so when we enter the name

![[Pasted image 20211117175942.png]]

We can see that it is not returing the input field so lets check where the input is going by viewing the source of the page

![[Pasted image 20211117180044.png]]

We can see that the name is reflecting the title of the page. So lets try with underline HTML tag and see what happens

![[Pasted image 20211117180155.png]]
![[Pasted image 20211117180211.png]]

We can see that it is displaying the tag but not rendering anything. So lets try to look at the source

![[Pasted image 20211117180321.png]]

We can see that as the tag is in the `title` tag the html is not rendering so lets escape it

So lets escape it by closing the `title` tag before our html payload so that the query becomes `<title> Welcome, </title><u>test</u>` and our payload will be `</title <u>test</u>`

![[Pasted image 20211117180622.png]]
![[Pasted image 20211117180638.png]]

We can see that HTML Injection is possible so lets enter some JS code

![[Pasted image 20211117180729.png]]
![[Pasted image 20211117180741.png]]

##### 4th website
![[Pasted image 20211117180925.png]]

We can see that it has a name section as an input field so when we enter the name

![[Pasted image 20211117180954.png]]

This time also it is not showing the input text, so lets go to devtools and check

![[Pasted image 20211117181108.png]]

This time it is appearing in two parts. But the part I'm most interested is in the url part or the JS code

If you notice the url after entering the name it looks like this

![[Pasted image 20211117181227.png]]

which is handled by the small js code as we have seen in devtools. So to escape it is quite similar as the previous examples but this time in JS. So lets try putting a  `'` and `;` at the end of the name so that the `name` variable is closed

![[Pasted image 20211117181831.png]]
![[Pasted image 20211117181928.png]]

If you notice carefully the url is encoded and in the code we can see that the semicolon has closed the variable name so lets put our JS code after that. It will look something like this
`test';alert(1);//`. Here what is happening is , after closing the variable we are running the JS command `alert` for the pop-up window and after that closing it with `;` and commenting the rest of the code with `//` so that their is no program related erros

![[Pasted image 20211117181726.png]]
![[Pasted image 20211117181949.png]]
![[Pasted image 20211117182010.png]]
